!function(e,n){"use strict";var t="undefined"==typeof window?global:window,r=n(t);module.exports=r}(this,function(e){"use strict";function n(){return this}var t,r,i,u,o,l=require("atma-formatter"),c=100,a=75,f=50,s=25,g=0,h={logCaller:!0,logDate:!1,color:"ascii"},d=f,v={};!function(){t=function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","")},r=function(e){"function"==typeof e&&(e=e.prototype);for(var n,t,r=1,i=arguments.length;i>r;r++){n="function"==typeof arguments[r]?arguments[r].prototype:arguments[r];for(t in n)e[t]=n[t]}return e},i=function(e,n){if(null==n)return e;for(var t in n)e[t]=n[t];return e},u=function(){function e(r){if(null==r)return r;var i,u=t(r);switch(u){case"String":case"Number":case"Date":case"RegExp":case"Function":case"Error":case"Boolean":return r;case"Array":case"Arguments":i=[];for(var o=0,l=r.length;l>o;o++)i[o]=e(r[o]);return i;case"Object":case"global":if(-1!==n.indexOf(r))return"<circular>";n.push(r),i={};for(var c in r)i[c]=e(r[c]);return i;default:return console.warn("obj_dimissCircular: Unknown type",u),r}}var n;return function(t){return"object"==typeof t&&null!=t&&(n=[],t=e(t),n=null),t}}(),o=function(){function e(e){for(var n="",t=0;e>t;t++)n+="  ";return n}return function n(r,i,u){null==u&&(u=0);var o=["",0];if("undefined"==typeof r)return o[1]="<undefined>",i(o,"undefined"),o[1];if(null==r)return o[1]="<null>",i(o,"null"),o[1];var l=t(r);switch(l){case"Array":case"Arguments":for(var c,a="[",f=r,s=0,g=f.length;g>s;s++)c=f[s],"["===a&&(a+="\n"),a+=e(u+1)+n(c,i,u+1)+(g-1>s?",":"")+"\n";return a+=e(u)+"]";case"RegExp":return o[1]=r.toString(),i(o,"regexp"),o[1];case"Date":return o[1]=r.toISOString(),i(o,"date"),o[1];case"String":case"Number":case"Boolean":return o[1]=r,i(o,l.toLowerCase()),o[1];case"Function":return o[1]="<function>",i(o,l.toLowerCase()),o[1];case"Error":return r.toString().red;case"Object":case"global":var h,a="{",d=Object.keys(r);for(s=0,g=d.length;g>s;s++)h=d[s],"{"===a&&(a+="\n"),o[0]=h,o[1]=r[h],i(o),a+=e(u+1)+o[0]+": "+n(r[h],i,u+1)+(g-1>s?",":"")+"\n";return a+=e(u)+"}"}}}()}();var p;!function(){function e(e){")"===e[e.length-1]&&(e=e.substr(e.indexOf("(")+1,e.lastIndexOf(")")-1));var r=/^(.+):(\d+):(\d)/.exec(e);if(null==r)return null;var i=t.path=r[1];return t.file=i.substring(i.search(/[\/\\][^\/\\]+$/)+1),t.line=r[2],null==n&&(n=t.file),t}var n,t={path:null,file:null,line:null};p=function(t){for(var r,i=(new Error).stack.split("\n").splice(1),u=i.length,o=-1;++o<u&&(r=e(i[o]),null==r||null==n||r.file===n););return null==r||o===u?"":t.replace("P",r.path).replace("F",r.file).replace("L",r.line)}}();var y;!function(){y=function(e){return"string"!=typeof e&&(e="dd-MM hh:mm:ss"),l(new Date,e)}}();var m,b;!function(){b=function(e){var n=m(e);return h.logCaller!==!1&&(n+=p(" (F:L)",5)),h.logDate!==!1&&(n=y(h.logDate)+" "+n),n},m=function(e){for(var n,t,r="",i=/%s|%d/,u=e.length>1&&"string"==typeof e[0]&&i.test(e[0]),o=0,l=e.length;l>o;o++)t=e[o],n="string"==typeof t?t:_.formatJSON(t),o>0&&u&&i.test(r)?r=r.replace(i,n):(""!==r&&(r+="  "),r+=n);return r}}();var w;!function(){w=function(e,n){switch(e){case"level":d=n;break;case"levels":i(v,n);break;case"transport":x.define(n);break;case"color":_.define(n);case"logCaller":case"logDate":default:h[e]=n}}}();var S;!function(){S=function(n,t){var r=t,i=d;return(null==n||n instanceof k==0)&&(n=e),null!=n._level&&(r=n._level),i>=r?!0:null!=n.name&&(i=v[n._name],null!=i&&i>=r)?!0:!1};var e={_level:null,_name:null}}();var _=function(){function e(e){function n(e,n){for(var t,r=1,i=e.length,u=n;i>u;u++)if(t=e.charCodeAt(u),60===t&&r++,62===t&&r--,0===r)return u;return-1}function t(t){e.rgx_search.lastIndex=0;for(var i,u,o,l="ascii"===e.type,c=l?[]:null;i=e.rgx_search.exec(t),null!=i;)if(u=i[1],null!=e.value[u]){var a,f=i.index,s=f+i[0].length;o=n(t,s),-1!==o&&(a=e.start(u),t=t.substring(0,f)+a+t.substring(s,o)+e.END+(l?r(c,o):"")+t.substring(o+1),l&&c.push({end:o,key:u}),e.rgx_search.lastIndex=f+a.length)}return t}function r(n,t){for(var r,i="",u=0,o=n.length;o>u;u++)r=n[u],r.end<t||(i+=e.start(r.key));return i}if(null==e.rgx_search){var i="(";for(var u in e.value)i+="("===i?u:"|"+u;i+=")<",e.rgx_search=new RegExp(i,"g")}return Object.keys(e.value).forEach(function(n){try{Object.defineProperty(String.prototype,n,{get:function(){return e.start(n)+this+e.END},enumerable:!1,configurable:!0})}catch(t){}}),Object.defineProperty(String.prototype,"color",{get:function(){return t(this)},enumerable:!1,configurable:!0}),t}var n,t={END:"",value:{red:"",green:"",yellow:"",blue:"",magenta:"",cyan:"",bold:"",italic:"",underline:"",inverse:""},start:function(){return""}},r={END:"</span>",value:{red:"color:red",green:"color:green",yellow:"color:yellow",blue:"color:blue",magenta:"color:magenta",cyan:"color:cyan",bold:"font-weight:bold",italic:"font-style:italic",underline:"text-decoration:underline",inverse:"color:black;background:white"},start:function(e){var n='<span style="'+this.value[e]+'">';return n}},i={type:"ascii",START:"[",END:"[0m",value:{red:"31m",green:"32m",yellow:"33m",blue:"34m",magenta:"35m",cyan:"36m",white:"37m",black:"30m",bg_black:"40m",bg_red:"41m",bg_green:"42m",bg_yellow:"43m",bg_blue:"44m",bg_magenta:"45m",bg_cyan:"46m",bg_white:"47m",bold:"1m",italic:"3m",underline:"4m",inverse:"7m"},start:function(e){return this.START+this.value[e]}};n=e(i);var l={string:"yellow",number:"cyan","boolean":"cyan",regexp:"magenta",date:"magenta","function":"magenta","null":"blue",undefined:"blue"};return{init:{ascii:function(){n=e(i)},html:function(){n=e(r)},none:function(){n=e(t)}},colorize:function(e){return n(e)},formatJSON:function(e){var n=e;return void 0!==n&&"object"==typeof n&&(n=u(e)),o(n,function(e,n){n&&l[n]&&(e[1]=String(e[1])[l[n]]),e[0]&&(e[0]=e[0].bold)})},define:function(e){return _.init[e]?_.init[e]():void console.error("Invalid Color Type ",e)}}}(),x=function(){var e,n={};return n.std=function(){return{write:function(e){process.stdout.write("\n"+e)},cfg:function(){},std:!0}}(),n.fs=function(){function e(t){try{g.appendFileSync(s.resolve(n,"logger-exceptions.txt"),m([t])+p)}catch(r){"ENOENT"===r.code&&(x(n),e(t))}}var n,t,r,i,u,o,c,a,f,s=require("path"),g=require("fs"),d="logs",v="txt",p=require("os").EOL,y=524288e3,b=10,w=64,S=!1;!function(){var n=require("fs");require("path"),c=function(e){try{var t=n.lstatSync(e);return t&&t.size}catch(r){return 0}},a=function(t,r){n.unlink(t,function(n){n&&e(n),r(n)})},f=function(t){try{n.unlinkSync(t)}catch(r){e(r)}},o=function(t,r,i){return r?void n.open(t,"a",function(t,u){if(null!=t)return e(t),void i(t);var o=new Buffer(r,"utf8");n.write(u,o,0,o.length,0,function(t){t&&e(t),n.close(u,i)})}):void i()},u=function(t,r){if(r)try{var i=n.openSync(t,"a");n.writeSync(i,r),n.closeSync(i)}catch(u){e(u)}}}();var _,x;!function(){_=function(n){try{return g.readdirSync(n)}catch(t){return e(t),[]}},x=function(n){if(!g.existsSync(n)){x(s.dirname(n));try{g.mkdirSync(n)}catch(t){e(t)}}}}();var k;!function(){function e(e,n){r[n]={write:e.write,end:e.end}}function n(e,n){e.write=r[n].write,e.end=r[n].end}function t(e,n){e.write=e.end=function(e){null!=e&&("string"!=typeof e&&(e=e.toString()),"stderr"===n&&(e=e.red),j.write(e))}}var r={};e(process.stdout,"stdout"),e(process.stderr,"stderr"),k=function(e){var r=e!==!1?t:n;r(process.stdout,"stdout"),r(process.stderr,"stderr")}}();var E=function(e,t){this.buffer=[],this.path=s.resolve(n,e)+"."+r,this.size=t!==!0?0:c(this.path)};E.prototype={busy:!1,errored:!1,write:function(e){this.size+=e.length,this.buffer.push(e),this.buffer.length>w&&this[S?"flushSync":"flush"](),this.size>y&&D()},flush:function(){var e,n=this;n.busy||(n.busy=!0,e=this.getBuffer_(),o(n.path,e,function(){n.busy=!1}))},flushSync:function(){u(this.path,this.getBuffer_())},getBuffer_:function(){if(0===this.buffer.length)return"";var e=this.buffer.join(i)+i;return this.buffer.length=0,e}};var O,D;!function(){O=function(){i="html"===h.color?"<br/>":p,x(n);for(var e,r=_(n).sort(),u=r.length,o=/^\d+_/g;--u>-1&&(e=r[u],!o.test(e)););t=u>-1?new E(e.replace(/\.\w+$/,""),!0):D(),r.length>b&&r.slice(0,r.length-b).forEach(function(e){f(s.resolve(n,e))})},D=function(){null!=t&&t.flushSync();var e=new Date;return t=new E(e.getTime()+"_"+l(e,"dd-MM_hh"))}}();var j={write:function(e){null==t&&O(),t.write(e)},flush:function(){t.flushSync()},cfg:function(e){r=e.extension||v,n=s.resolve(s.dirname(module.parent.filename),e.directory||d),null!=e.bufferSize&&(w=e.bufferSize),e.filesCount&&(b=e.filesCount),e.fileSize&&(y=e.fileSize),null!=e.sync&&(S=e.sync),e.interceptStd&&k()},interceptStd:function(e){k(e)}};return j},e=n.std,{define:function(t){var r=t.type;return e=n[r],"function"==typeof e&&(e=e()),e.cfg(t),this},write:function(n){e.write(n)},get:function(){return e}}}(),k=function(){function t(n,r){function i(){return c.log.apply(c,arguments)}if(null==this||this===e)return new t(n,r);var u,o,l=typeof n;"number"===l&&(u=n,o=r),"string"===l&&(o=n,u=r),"number"==typeof u&&(this._level=u),"string"==typeof o&&(this._name=o);var c=this;return i.__proto__=c,i}var r={_name:null,_level:null,cfg:function(e){if("string"==typeof e){if(1===arguments.length)return h[e];w(e,arguments[1])}for(var n in e)w(n,e[n])},color:_,formatMessage:function(){return m(arguments)},log:function(){return S(this,f)&&x.write(b(arguments)),this},error:function(){return S(this,g)&&x.write(b(arguments).red.bold),this},warn:function(){return S(this,s)&&x.write(b(arguments).yellow.bold),this},debug:function(){return S(this,a)&&x.write(b(arguments)),this},trace:function(){return S(this,c)&&x.write(b(arguments)),this},getTransport:function(){return x.get()}};return{cfg:r.cfg,color:r.color,log:n,error:n,warn:n},i(t,r),t}();if("udefined"!=typeof process)for(var E,O=process.argv.slice(2),D=0,j=O.length;j>D;D++)switch(E=O[D].replace(/^\-+/,"")){case"no-color":k.cfg("color","none");break;case"level":var N=O[++D]<<0;if(0===N){k.warn("<logger> invalid cli command --level X");break}k.cfg("level",N)}return k});
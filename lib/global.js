!function(n,e){"use strict";var r="undefined"==typeof window?global:window,t=e(r);r.logger=t}(this,function(n){"use strict";function e(){return this}var r;r=require("atma-formatter");var t,o,u,i,c,a=100,l=75,f=50,s=25,g=0,h={formatMessage:!0,logCaller:!0,logDate:!1,color:"ascii"},d=f,v={};!function(){t=function(n){return Object.prototype.toString.call(n).replace("[object ","").replace("]","")},o=function(n){"function"==typeof n&&(n=n.prototype);for(var e,r,t=1,o=arguments.length;o>t;t++){e="function"==typeof arguments[t]?arguments[t].prototype:arguments[t];for(r in e)n[r]=e[r]}return n},u=function(n,e){if(null==e)return n;for(var r in e)n[r]=e[r];return n},i=function(){function n(r){if(null==r)return r;var o,u=t(r);switch(u){case"String":case"Number":case"Date":case"RegExp":case"Function":case"Error":case"Boolean":return r;case"Array":case"Arguments":o=[];for(var i=0,c=r.length;c>i;i++)o[i]=n(r[i]);return o;case"Object":case"global":if(-1!==e.indexOf(r))return"<circular>";e.push(r),o={};for(var a in r)o[a]=n(r[a]);return o;default:return console.warn("obj_dimissCircular: Unknown type",u),r}}var e;return function(r){return"object"==typeof r&&null!=r&&(e=[],r=n(r),e=null),r}}(),c=function(){function n(n){for(var e="",r=0;n>r;r++)e+="  ";return e}return function e(r,o,u){null==u&&(u=0);var i=["",0];if("undefined"==typeof r)return i[1]="<undefined>",o(i,"undefined"),i[1];if(null==r)return i[1]="<null>",o(i,"null"),i[1];var c=t(r);switch(c){case"Array":case"Arguments":for(var a,l="[",f=r,s=0,g=f.length;g>s;s++)a=f[s],"["===l&&(l+="\n"),l+=n(u+1)+e(a,o,u+1)+(g-1>s?",":"")+"\n";return l+=n(u)+"]";case"RegExp":return i[1]=r.toString(),o(i,"regexp"),i[1];case"Date":return i[1]=r.toISOString(),o(i,"date"),i[1];case"String":case"Number":case"Boolean":return i[1]=r,o(i,c.toLowerCase()),i[1];case"Function":return i[1]="<function>",o(i,c.toLowerCase()),i[1];case"Error":return r.toString().red;case"Object":case"global":var h,l="{",d=Object.keys(r);for(s=0,g=d.length;g>s;s++)h=d[s],"{"===l&&(l+="\n"),i[0]=h,i[1]=r[h],o(i),l+=n(u+1)+i[0]+": "+e(r[h],o,u+1)+(g-1>s?",":"")+"\n";return l+=n(u)+"}"}}}()}();var p;!function(){function n(n){")"===n[n.length-1]&&(n=n.substr(n.indexOf("(")+1,n.lastIndexOf(")")-1));var t=/^(.+):(\d+):(\d)/.exec(n);if(null==t)return null;var o=r.path=t[1];return r.file=o.substring(o.search(/[\/\\][^\/\\]+$/)+1),r.line=t[2],null==e&&(e=r.file),r}var e,r={path:null,file:null,line:null};p=function(r){for(var t,o=(new Error).stack.split("\n").splice(1),u=o.length,i=-1;++i<u&&(t=n(o[i]),null==t||null==e||t.file===e););return null==t||i===u?"":r.replace("P",t.path).replace("F",t.file).replace("L",t.line)}}();var b;!function(){b=function(n){return"string"!=typeof n&&(n="dd-MM hh:mm:ss"),r(new Date,n)}}();var y,m;!function(){m=function(n,e){if(h.formatMessage===!1)return n;var r=y(n);return null!=e._name&&(r=e._name.color+" "+r),h.logCaller!==!1&&(r+=p(" (F:L)",5)),h.logDate!==!1&&(r=b(h.logDate)+" "+r),r},y=function(n){for(var e,r,t="",o=/%s|%d/,u=n.length>1&&"string"==typeof n[0]&&o.test(n[0]),i=0,c=n.length;c>i;i++)r=n[i],e="string"==typeof r?r:x.formatJSON(r),i>0&&u&&o.test(t)?t=t.replace(o,e):(""!==t&&(t+=" "),t+=e);return t}}();var w;!function(){function n(n){var e=E.error(n).getTransport();e&&e.flush&&e.flush(),process.exit(1)}w=function(e){process.removeListener("uncaughtException",n),e!==!1&&process.on("uncaughtException",n)}}();var _;!function(){_=function(n,e){switch(n){case"level":d=e;break;case"levels":u(v,e);break;case"transport":k.define(e);break;case"handleExceptions":w(e);break;case"color":x.define(e);case"logCaller":case"logDate":default:h[n]=e}}}();var S;!function(){S=function(e,r){var t=r,o=d;return(null==e||e instanceof E==0)&&(e=n),null!=e._level&&(t=e._level),o>=t?!0:null!=e.name&&(o=v[e._name],null!=o&&o>=t)?!0:!1};var n={_level:null,_name:null}}();var x=function(){function n(n){function e(n,e){for(var r,t=1,o=n.length,u=e;o>u;u++)if(r=n.charCodeAt(u),60===r&&t++,62===r&&t--,0===t)return u;return-1}function r(r){n.rgx_search.lastIndex=0;for(var o,u,i,c="ascii"===n.type,a=c?[]:null;o=n.rgx_search.exec(r),null!=o;)if(u=o[1],null!=n.value[u]){var l,f=o.index,s=f+o[0].length;i=e(r,s),-1!==i&&(l=n.start(u),r=r.substring(0,f)+l+r.substring(s,i)+n.END+(c?t(a,i):"")+r.substring(i+1),c&&a.push({end:i,key:u}),n.rgx_search.lastIndex=f+l.length)}return r}function t(e,r){for(var t,o="",u=0,i=e.length;i>u;u++)t=e[u],t.end<r||(o+=n.start(t.key));return o}if(null==n.rgx_search){var o="(";for(var u in n.value)o+="("===o?u:"|"+u;o+=")<",n.rgx_search=new RegExp(o,"g")}return Object.keys(n.value).forEach(function(e){try{Object.defineProperty(String.prototype,e,{get:function(){return n.start(e)+this+n.END},enumerable:!1,configurable:!0})}catch(r){}}),Object.defineProperty(String.prototype,"color",{get:function(){return r(this)},enumerable:!1,configurable:!0}),r}var e,r,t={END:"",value:{red:"",green:"",yellow:"",blue:"",magenta:"",cyan:"",bold:"",italic:"",underline:"",inverse:""},start:function(){return""}};!function(){r={END:"</span>",value:{red:"color:red",green:"color:green",yellow:"color:yellow",blue:"color:blue",magenta:"color:magenta",cyan:"color:cyan",bg_black:"background-color:black",bg_red:"background-color:red",bg_green:"background-color:green",bg_yellow:"background-color:yellow",bg_blue:"background-color:blue",bg_magenta:"background-color:magenta",bg_cyan:"background-color:cyan",bg_white:"background-color:white",bold:"font-weight:bold",italic:"font-style:italic",underline:"text-decoration:underline",inverse:"color:black;background:white"},start:function(n){var e='<span style="'+this.value[n]+'">';return e}},!function(){function n(n){return r[n]}function e(e){return e.replace(/[&"'\<\>\/]/g,n)}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return e}()}();var o={type:"ascii",START:"[",END:"[0m",value:{red:"31m",green:"32m",yellow:"33m",blue:"34m",magenta:"35m",cyan:"36m",white:"37m",black:"30m",bg_black:"40m",bg_red:"41m",bg_green:"42m",bg_yellow:"43m",bg_blue:"44m",bg_magenta:"45m",bg_cyan:"46m",bg_white:"47m",bold:"1m",italic:"3m",underline:"4m",inverse:"7m"},start:function(n){return this.START+this.value[n]}};e=n(o);var u={string:"yellow",number:"cyan","boolean":"cyan",regexp:"magenta",date:"magenta","function":"magenta","null":"blue",undefined:"blue"};return{init:{ascii:function(){e=n(o)},html:function(){e=n(r)},none:function(){e=n(t)}},colorize:function(n){return e(n)},formatJSON:function(n){var e=n;return void 0!==e&&"object"==typeof e&&(e=i(n)),c(e,function(n,e){e&&u[e]&&(n[1]=String(n[1])[u[e]]),n[0]&&(n[0]=n[0].bold)})},define:function(n){return x.init[n]?x.init[n]():void console.error("Invalid Color Type ",n)}}}(),k=function(){var n,e={};return e.std=function(){return{write:function(n){process.stdout.write("\n"+n)},cfg:function(){},std:!0}}(),e.stream=function(){var n;return{write:function(e){n.write(e)},cfg:function(e){var r=e.stream;if(null==r)throw Error("Transport Configuration: No `stream` property");if(null==r.write)throw Error("Transport Configuration: Invalid stream object");n=r}}}(),e.fs=function(){function n(r){try{g.appendFileSync(s.resolve(e,"logger-exceptions.txt"),y([r])+p)}catch(t){"ENOENT"===t.code&&(x(e),n(r))}}var e,t,o,u,i,c,a,l,f,s=require("path"),g=require("fs"),d="logs",v="txt",p=require("os").EOL,b=512e3,m=10,w=0,_=!1;!function(){var e=require("fs");require("path"),a=function(n){try{return e.lstatSync(n).size}catch(r){return 0}},l=function(r,t){e.unlink(r,function(e){e&&n(e),t(e)})},f=function(r){try{e.unlinkSync(r)}catch(t){n(t)}},c=function(r,t,o){return t?void e.open(r,"a",function(r,u){if(null!=r)return n(r),void o(r);var i=new Buffer(t,"utf8");e.write(u,i,0,i.length,0,function(r){r&&n(r),e.close(u,o)})}):void o()},i=function(r,t){if(t)try{var o=e.openSync(r,"a");e.writeSync(o,t),e.closeSync(o)}catch(u){n(u)}}}();var S,x;!function(){S=function(e){try{return g.readdirSync(e)}catch(r){return n(r),[]}},x=function(e){if(!g.existsSync(e)){x(s.dirname(e));try{g.mkdirSync(e)}catch(r){n(r)}}}}();var k;!function(){function n(n,e){t[e]={write:n.write,end:n.end}}function e(n,e){n.write=t[e].write,n.end=t[e].end}function r(n,e){n.write=n.end=function(n){null!=n&&("string"!=typeof n&&(n=n.toString()),"stderr"===e&&(n=n.red),D.write(n))}}var t={};n(process.stdout,"stdout"),n(process.stderr,"stderr"),k=function(n){var t=n!==!1?r:e;t(process.stdout,"stdout"),t(process.stderr,"stderr")}}();var E=function(n,r){this.buffer=[],this.path=s.resolve(e,n)+"."+o,this.size=r!==!0?0:a(this.path)};E.prototype={busy:!1,errored:!1,write:function(n){this.size+=n.length+u.length,this.buffer.push(n),this.buffer.length>w&&this[_?"flushSync":"flush"](),this.size>=b&&j()},flush:function(){var n,e=this;e.busy||(e.busy=!0,n=this.getBuffer_(),""!==n&&c(e.path,n,function(){e.busy=!1,e.buffer.length>w&&e.flush()}))},flushSync:function(){var n=this.getBuffer_();""!==n&&i(this.path,n)},getBuffer_:function(){if(0===this.buffer.length)return"";var n=this.buffer.join(u)+u;return this.buffer.length=0,n}};var O,j;!function(){O=function(){u="html"===h.color?"<br/>":p,x(e);for(var n,r=S(e).sort(),o=r.length,i=/^\d+_/g;--o>-1&&(n=r[o],!i.test(n)););t=o>-1?new E(n.replace(/\.\w+$/,""),!0):j(),t.size>=b&&j(),r.length>=m&&r.slice(0,r.length-m+1).forEach(function(n){f(s.resolve(e,n))})},j=function(){null!=t&&t.flushSync();var e=new Date;return t=new E(e.getTime()+"_"+n++ +"_"+r(e,"dd-MM_hh"))};var n=0}();var D={write:function(n){null==t&&O(),t.write(n)},flush:function(){t.flushSync()},cfg:function(n){o=n.extension||v,e=s.resolve(s.dirname(module.parent.filename),n.directory||d),null!=n.bufferSize&&(w=n.bufferSize),n.filesCount&&(m=n.filesCount),n.fileSize&&(b=n.fileSize),null!=n.sync&&(_=n.sync),n.interceptStd&&k()},interceptStd:function(n){k(n)}};return D},n=e.std,{define:function(r){var t=r.type;return n=e[t],"function"==typeof n&&(n=n()),n.cfg(r),this},write:function(e){n.write(e)},get:function(){return n}}}(),E=function(){function r(n,e){return function(){if(S(this,n)===!1)return this;var r=m(arguments,this);return e&&"string"==typeof r&&(r=e(r)),k.write(r),this}}function t(e,r){function o(){return a.log.apply(a,arguments)}if(null==this||this===n)return new t(e,r);var u,i,c=typeof e;"number"===c&&(u=e,i=r),"string"===c&&(i=e,u=r),"number"==typeof u&&(this._level=u),"string"==typeof i&&(this._name=i);var a=this;return o.__proto__=a,o}var o={_name:null,_level:null,cfg:function(n){if(0===arguments.length)return h;if("string"==typeof n){if(1===arguments.length)return h[n];_(n,arguments[1])}for(var e in n)_(e,n[e])},color:x,formatMessage:function(){return y(arguments)},log:r(f),warn:r(s,function(n){return n.yellow.bold}),debug:r(l),trace:r(a),error:r(g,function(n){return n.red.bold}),getTransport:function(){return k.get()}};return{cfg:o.cfg,color:o.color,log:e,error:e,warn:e},t.prototype=o,u(t,o),t}();if("undefined"!=typeof process)for(var O,j=process.argv.slice(2),D=0,C=j.length;C>D;D++)switch(O=j[D].replace(/^\-+/,"")){case"no-color":E.cfg("color","none");break;case"level":var N=j[++D]<<0;if(0===N){E.warn("<logger> invalid cli command --level X");break}E.cfg("level",N)}return E});